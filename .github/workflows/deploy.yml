name: Deploy Theme

on:
  push:
    tags:
      - "v*"
      - "*.*.*"
  workflow_dispatch:
    inputs:
      version:
        description: "Override version to deploy when running manually (e.g. 1.2.3)"
        required: false
      build-dir:
        description: "Optional build directory to deploy instead of the repo root"
        required: false
        default: ""
      generate-zip:
        description: "Also produce a ZIP from the deployed tag"
        required: false
        default: "false"
      dry-run:
        description: "Set to true to test the workflow without committing to SVN"
        required: false
        default: "false"

jobs:
  deploy:
    name: Deploy to WordPress.org
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Checkout theme
        uses: actions/checkout@v4

      - name: Deploy
        uses: kishanjasani/action-wordpress-theme-deploy@9c8d8145b56df64a45565512980cc93eac924ae4
        with:
          slug: deltra
          version: ${{ inputs.version }}
          build-dir: ${{ inputs.build-dir }}
          generate-zip: ${{ inputs.generate-zip }}
          dry-run: ${{ inputs.dry-run }}
        env:
          SVN_USERNAME: ${{ secrets.WPORG_SVN_USERNAME }}
          SVN_PASSWORD: ${{ secrets.WPORG_SVN_PASSWORD }}
